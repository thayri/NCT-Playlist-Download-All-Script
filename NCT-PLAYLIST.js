function downloadAll () {e = $ (".playing_absolute") [0], uxml = e.innerHTML.match ('https?: // (www.)? nhaccuatui.com/flash/xml? [^ "] * ') [0], request = new XMLHttpRequest, request.onreadystatechange = function () {if (4 == request.readyState && 200 == request.status) {for (xml = request.responseText, console.log (xml), liên kết = "", matchers = xml.match (/ https?: \ / \ / [^ \]] * \. mp3 / gm), i = 0; i <matchers.length; i ++) liên kết = liên kết + (links.length > 0? "\ R \ n": "") + đối sánh [i]; document.getElementById ("nctaa"). InnerHTML = "<a href = 'javascript :;' style = 'color: blue;' onclick = '_ downloadNow ();'> Tải ngay </a> <br/> <a href = \ "dữ liệu: text / plain; charset = utf-8," + encodeURIComponent (liên kết) + '"download =" nhaccuatui Danh sách liên kết Mp3 của Điệp Esc.txt "style =" color: blue; " > Ignoring this link to load txt </a> or copy links from 'right' below ', $ ("# ta_downloadlinks"). RemoveClass ("hide"), $ ("# ta_downloadlinks") [0] .value = links}}, request.open ("GET", uxml,! 0), hàm requestUI ()} initUI () {e = document.createElement ("li"), e.innerHTML = '<li > <a href = "javascript :;" id = "DiepEsc" onclick = "downloadAll ();"> <span class = "icon_download"> </ span> Tải xuống tất cả </a> </ li> ', $ (". box_menu_player> ul") [0] .appendChild (e), $ ($ (". box_menu_player> ul> li") [1]). hide (), $ ("# btnDownloadPlaylist"). addClass ("ẩn"), e.outerHTML = e.outerHTML + "<br> <br> <p id = \" nctaa \ "> </ p> <textarea class = 'ẩn' id = ' ta_downloadlinks 'style =' margin: 0px; chiều cao: 130px; chiều rộng: 100%; thay đổi kích thước: none; text-indent: 0; '> </ textarea> "} _ downloadNow = function () {for (links = document.getElementById (" ta_downloadlinks "). value.split (" \ n "), i = 0; i <liên kết . ingth) liên kết [i] .trim (). length> 0 && (e = document.createElement ("a"), e.setAttribute ("href", liên kết [i] .trim ()), e.setAttribute ("tải xuống", "Điệp Esc"), e.click ())}, initUI ();